# 햄버거 챗봇 개발 TASK 로드맵 (MVP부터 확장까지)

이 문서는 최종 기술 요구사항 명세서(v3.0)를 기반으로, MVP(최소 기능 제품)부터 시작하여 점진적으로 기능을 확장하고 테스트할 수 있도록 개발 TASK를 단계별로 정의합니다.

---

## **Phase 1: MVP - 핵심 기반 구축**

**목표:** 사용자가 **정확한 메뉴 이름**을 말했을 때, **단품 메뉴** 하나를 장바구니에 담는 가장 기본적인 흐름을 완성합니다.

-   **Task 1.1: DB 스키마 및 샘플 데이터 구축**
    -   **내용:** 명세서에 정의된 `MenuCategory`, `Products`, `Cart` 등 모든 테이블을 DB에 생성합니다.
    -   **검증:** 제공된 샘플 데이터를 모두 INSERT하고, 수동으로 조회하여 데이터가 정확한지 확인합니다.

-   **Task 1.2: `findProduct` 함수 (정확한 이름 검색 버전)**
    -   **내용:** 시맨틱 검색 없이, **SQL `LIKE` 또는 `=`** 를 사용하여 사용자의 `query`와 정확히 일치하는 상품을 `Products` 테이블에서 찾는 버전을 먼저 구현합니다.
    -   **검증:** `'한우불고기버거'`를 검색했을 때 `'A00001'` 상품 정보를 정확히 반환하는지 단위 테스트(Unit Test)를 수행합니다.

-   **Task 1.3: `addToCart` 함수 (단품 버전)**
    -   **내용:** 단품(`product_type != 'set'`) 메뉴 하나를 `Cart` 테이블에 추가하는 로직을 구현합니다.
    -   **검증:** `findProduct`로 찾은 `'A00001'` 상품 정보를 `addToCart`에 전달했을 때, `Cart` 테이블에 해당 내용이 정확히 기록되는지 테스트합니다.

-   **Task 1.4: 기본 대화 흐름 연결**
    -   **내용:** LLM, `findProduct`, `addToCart`를 연결하여 "한우불고기버거 주세요" -> "네, 장바구니에 담았습니다." 까지 이어지는 가장 단순한 대화 흐름을 완성합니다.
    -   **검증:** 실제 챗봇 인터페이스를 통해 시나리오를 처음부터 끝까지 테스트합니다.

-   **Task 1.5: 수량 처리 기능 추가**
    -   **내용:** 고객이 "한우불고기버거 3개 주세요"처럼 수량을 명시했을 때, LLM이 수량을 파악하여 `addToCart` 함수의 `quantity` 파라미터에 정확히 반영하도록 구현합니다. 수량 언급이 없으면 기본값 1개로 처리합니다.
    -   **검증:** "한우불고기버거 3개 주세요" 시나리오 테스트 시, `addToCart(session_id, "A00001", quantity=3)`가 호출되고 장바구니에 3개가 담기는지 확인합니다.

---

## **Phase 2: 세트 메뉴 및 옵션 처리 기능 확장**

**목표:** MVP 위에 세트 메뉴 주문과 기본 옵션 변경 기능을 추가합니다. '대화형 검증'의 핵심 로직이 여기서 구현됩니다.

-   **Task 2.1: `getSetComposition` 함수 구현**
    -   **내용:** 명세서대로 세트 상품 ID를 입력받아 기본 구성품 목록을 반환하는 함수를 구현합니다.
    -   **검증:** `'G00001'`(한우불고기버거 세트) ID를 입력했을 때, 구성품 `['A00001', 'B00001', 'C00001']`이 정확히 반환되는지 단위 테스트를 수행합니다.

-   **Task 2.2: `addToCart` 함수 (세트 메뉴 지원 버전)**
    -   **내용:** 세트 메뉴가 들어왔을 때, `getSetComposition`을 호출하여 모든 구성품을 `set_group_id`로 묶어 `Cart` 테이블에 추가하도록 기존 함수를 확장합니다.
    -   **검증:** `'G00001'` 상품을 `addToCart` 했을 때, `Cart` 테이블에 3개의 행이 동일한 `set_group_id`로 기록되는지 테스트합니다.

-   **Task 2.3: 대화 흐름 (옵션 변경 로직)**
    -   **내용:** "한우불고기버거 세트에서 감자튀김을 양념감자로 바꿔줘" 시나리오를 처리하는 핵심 로직을 구현합니다. (카테고리 검증, 가격 차이 계산, 사용자에게 되묻기)
    -   **검증:** 해당 시나리오를 직접 테스트하여, 시스템이 정확한 추가금을 계산하고 사용자에게 확인 질문을 하는지, 그리고 사용자가 "네"라고 답했을 때 변경된 '양념감자'가 장바구니에 담기는지 확인합니다.

---

## **Phase 3: 검색 고도화 및 사용자 경험 개선**

**목표:** 사용자의 모호한 요청을 처리하고, 장바구니 관리 기능을 추가하여 실제 사용성을 높입니다.

-   **Task 3.1: `findProduct` 함수 (시맨틱 검색 업그레이드)**
    -   **내용:** 기존의 SQL `LIKE` 검색 로직을 **임베딩 기반의 시맨틱 검색**으로 교체합니다. `AMBIGUOUS` 상태를 반환하는 로직을 추가합니다.
    -   **검증:** "매콤한 감자"를 검색했을 때 '양념감자 (칠리)'가 상위 결과로 나오는지, "양념감자"를 검색했을 때 `status: 'AMBIGUOUS'`와 함께 4개의 후보가 반환되는지 테스트합니다.

-   **Task 3.2: 대화 흐름 (모호성 처리 로직)**
    -   **내용:** `findProduct`가 `AMBIGUOUS`를 반환했을 때, 사용자에게 "어떤 맛으로 드릴까요?" 와 같이 선택지를 제시하는 로직을 구현합니다.
    -   **검증:** "양념감자 주세요"라고 입력했을 때, 챗봇이 맛 선택지를 제시하고 사용자의 답변에 따라 정확한 메뉴를 장바구니에 담는지 테스트합니다.

-   **Task 3.3: 장바구니 관리 함수 구현**
    -   **내용:** `getCartDetails`, `updateCartItem`, `clearCart` 함수를 모두 구현합니다.
    -   **검증:** "장바구니 보여줘", "수량 2개로 바꿔줘", "주문 취소해줘" 등의 시나리오를 테스트하여 각 함수가 정확히 동작하는지 확인합니다.

---

## **Phase 4: 최종 주문 및 완성**

**목표:** 전체 주문을 완료하고, 시스템의 안정성을 높입니다.

-   **Task 4.1: `processOrder` 함수 구현**
    -   **내용:** `Cart` 테이블의 내용을 `Orders`와 `Order_Items` 테이블로 옮기고 장바구니를 비우는 최종 주문 확정 로직을 구현합니다.
    -   **검증:** 주문 완료 후 `Orders` 테이블에 정확한 총액이 기록되고, `Cart` 테이블이 비워지는지 테스트합니다.

-   **Task 4.2: 오류 처리 및 로깅 시스템 구축**
    -   **내용:** 명세서에 정의된 재시도 메커니즘과 예외 처리 로직을 시스템 전반에 적용하고, 오류 발생 시 파일이나 DB에 로그를 기록하도록 구현합니다.
    -   **검증:** 의도적으로 오류(예: DB 연결 끊기)를 발생시켜 시스템이 gracefully 실패하고 로그를 남기는지 확인합니다.